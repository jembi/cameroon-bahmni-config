language: java
jdk: openjdk8
before_install:
- openssl aes-256-cbc -K $encrypted_b6b540ec2d3b_key -iv $encrypted_b6b540ec2d3b_iv -in .deploy_key.enc -out /tmp/deploy_key -d
- eval "$(ssh-agent -s)"
- chmod 600 /tmp/deploy_key
- ssh-add /tmp/deploy_key
- cd report-testing-framework
- sh start_mysql_test_db.sh
addons:
  ssh_known_hosts:
  - cmr-dev.jembi.org
  - cmr-staging.jembi.org
script:
  - cd report-testing
  - mvn test
  - cd ../..
deploy:
- provider: script
  script: bash scripts/travis/deploy.sh dev $mysql_password
  on:
    branch: dev
- provider: script
  script: bash scripts/travis/deploy.sh staging $mysql_password
  on:
    branch: staging